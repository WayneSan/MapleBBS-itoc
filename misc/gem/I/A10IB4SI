µo«H¤H: BioStar.bbs@micro.bio.ncue.edu.tw (¼ê´ò¤p¶³³¶) ¬ÝªO: plan
¼Ð  ÃD: Re: ½Ð°Ý²Ö¿n¤W¯¸®É¼Æ
µo«H¯¸: Àº¤Ñ±^ (Sat, 01 Nov 2003 00:39:02 +0800 (CST))    Updated: 2004/09/17

  §ï¤F ACCT Äæ¦ì­n transacct

: src/include/struct.h: struct ACCT

  time_t firstlogin;            /* ²Ä¤@¦¸¤W¯¸®É¶¡ */
  time_t lastlogin;             /* ¤W¤@¦¸¤W¯¸®É¶¡ */
  time_t tcheck;                /* ¤W¦¸ check «H½c/¦n¤Í¦W³æªº®É¶¡ */
  time_t tvalid;                /* ³q¹L»{ÃÒªº®É¶¡ */
+ time_t staytime;              /* ±¾¯¸Á`®É¶¡ */

: src/maple/bbsd.c:u_exit()

  utmp_free();                  /* ÄÀ©ñ UTMP shm */

- diff = (time(&cuser.lastlogin) - ap_start) / 60;
+ diff = time(&cuser.lastlogin) - ap_start;
+ cuser.staytime += diff;
+ diff /= 60;
  sprintf(fpath, "Stay: %d (%d)", diff, currpid);
  blog(mode, fpath);

: acct.c:acct_show()

  usr_fpath(buf, uid, fn_dir);
  prints("  \033[32m­Ó¤H«H¥ó¡G\033[37m%d «Ê\n", rec_num(buf, sizeof(HDR)));

+ diff = u->staytime / 60;
+ prints("  \033[32m±¾¯¸®É¼Æ¡G\033[37m%d ®É %d ¤À\n", diff / 60 , diff % 60);

--
 [1;41m¢z[44m¢q[m Or[1mig[30min[m: [41m ¹ü¤Æ®v¤j¥Íª«¨t£»§u­·¡E²·¤ë¡EÀº¤Ñ±^ [32;47m micro.bio.ncue.edu.tw [m
 [1;42m¢q[45m¢}[m A[1mut[30mho[mr: [1;33mBioStar [30m±q [35m163.23.212.18 [30mµoªí[m
