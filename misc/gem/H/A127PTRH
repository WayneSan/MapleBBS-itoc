µo«H¤H: guessi.bbs@bbs.wretch.cc (¨S) ¬ÝªO: plan
¼Ð  ÃD: [¥\¯à] ¤å³¹«O±K (¥H±K½X«OÅ@)
µo«H¯¸: µL¦W¤p¯¸ (2006/05/31 Wed 05:43:55)                Updated: 2006/06/01

¤å³¹¥[±K ¥H±K½X«OÅ@ ¬ÝªO¤å³¹¥[¤W¥|¦ì¼Æ±K½X

°£§@ªÌ¤§¥~¾\Åª §¡¥²¶·¿é¤J±K½X¤~¯à¾\Åª(¯¸ªø¤]¤£¨Ò¥~)


[32m:/src/include/hdr.h[m

- char nick[49];                /* ¼ÊºÙ */
+ char nick[44];                /* ¼ÊºÙ */
+ char pass[5];                 /* ¥|¦ì¼Æ±K½X */

..
..

}          HDR;

..
..

-  #define POST_4          0x00000008
+  #define POST_PASS       0x00000008      /* ¥[±K¤å³¹ ¥B¦³±K½X */


[32m:/src/maple/post.c:post_cb[][m

+  'W', post_pass,


[32m:/src/maple/post.c:post_browse()[m
[32m:/src/maple/xpost.c:xpost_browse()[m

+  char ckpass[5];

..
..

+   if ((xmode & POST_PASS) && strcmp(hdr->owner, cuser.userid))
+   {
+     if (!vget(b_lines, 0, MSG_PASSWD, ckpass, 5, NOECHO))
+        break;
+     if (strcmp(ckpass, hdr->pass))
+     {
+        vmsg("±K½X¿ù»~");
+        break;
+     }
+     else
+       vmsg("±K½X¥¿½T");
+   }

    hdr_fpath(fpath, dir, hdr);

    /* Thor.990204: ¬°¦Ò¼{more ¶Ç¦^­È */
    if ((key = more(fpath, FOOTER_POST)) < 0)
      break;

[32m:/src/maple/post.c ·s¼W¨ç¦¡¦b post_help()«e­±[m

static int
post_pass(xo)
  XO *xo;
{
  HDR *hdr;
  int pos, cur;
  char pass[5];

  if (!cuser.userlevel)
    return XO_NONE;

  if(!strcmp(currboard, BN_DELETED) ||
     !strcmp(currboard, BN_JUNK) ||
     !strcmp(currboard, BN_SECURITY))
    return XO_NONE;

  pos = xo->pos;
  cur = pos - xo->top;
  hdr = (HDR *) xo_pool + cur;

  if (hdr->xmode & POST_BOTTOM)
    return XO_NONE;

  if (!strcmp(hdr->owner, cuser.userid))
  {
     if (vans((hdr->xmode & POST_PASS) ?
       "¸Ñ°£±K½X(Y/N)¡H[N] " : "¤å³¹¥[±K(Y/N)¡H[N] ") == 'y')
     {
       hdr->xmode ^= POST_PASS;
       if (hdr->xmode & POST_PASS)
       {
         vget(b_lines, 0, MSG_PASSWD, pass, 5, NOECHO);
         strcpy(hdr->pass, pass);
       }
       else
         hdr->pass[0] = '\0';
     }

     currchrono = hdr->chrono;
     rec_put(xo->dir, hdr, sizeof(HDR),
       xo->key == XZ_XPOST ? hdr->xid : pos, cmpchrono);
     move(3 + cur, 7);
     outc(post_attr(hdr));
  }

  return XO_FOOT;
}


[32m:/src/maple/post.c:hdr_outs()[m

  /* --------------------------------------------------- */
  /* ¦L¥X¼ÐÃDªººØÃþ                                      */
  /* --------------------------------------------------- */

+ if ((hdr->xmode & POST_PASS) && strcmp(hdr->owner, cuser.userid))
+ {
+   title = "<< ³o½g¤å³¹»Ý­n±K½X >>";
+   ch = 1;
+ }
+ else
+ {

..
..

+ }


[32m:/src/maple/post.c:post_reply()[m
[32m:/src/maple/post.c:post_score()[m
[32m:/src/maple/post.c:post_bottom()[m

+   if (hdr->xmode & POST_PASS)
+     return XO_NONE;

[32m:/src/maple/post.c:post_edit()[m  [32m§@ªÌ­×§ï¤º®e[m
[32m:/src/maple/post.c:post_title()[m [32m§@ªÌ­×§ï¼ÐÃD[m  [32m³o¸Ìªºhdr½Ð§ï¬°fhdr[m
[32m:/src/maple/post.c:post_cross()[m
[32m:/src/maple/post.c:post_score()[m
[32m:/src/maple/xover.c:xo_forward()[m

+ if ((hdr->xmode & POST_PASS) && strcmp(hdr->owner, cuser.userid))
+   return XO_NONE;


¨ä¾l¥\¯à d D ^D µ¥... ­Y¦³»Ý­n½Ð¦Û¦æ¸É¤W§PÂ_¦¡ :)

--
[1;30;40m¤Ò§LªÌ¤£²»¤§¾¹ª«©Î´c¤§¬G¦³¹DªÌ¤£³B§g¤l©~«h¶Q¥ª¥Î§L«h¶Q¥k§LªÌ¤£²»¤§¾¹«D§g¤l[m
[1;30m¤§¾¹¤£±o¤w[37m[30m¦Ó¥Î¤§«ï²H¬°¤W³Ó¦Ó¤£¬ü¦Ó¬ü¤§ªÌ¬O¼Ö±þ¤H¤Ò¼Ö±þ¤HªÌ«h¤£¥i±o§Ó©ó¤Ñ¤U
[m[1;30m¨o¦N¨Æ©|¥ª¤¿¨Æ©|¥k°¾±N­x©~¥ª¤W±N­x©~¥k¨¥¥H³àÂ§³B¤§±þ¤H¤§²³¥H«s´dª_¤§¾Ô³Ó¥H[m
[1;30m³àÂ§³B¤§¹D±`[37mµL¦W[30m¾ëÁö¤p¤Ñ¤U²ö¯à¦Ú«J¤ý­Y¯à¦u¤§¸Uª«±N¦Û»«¤Ñ¦a¬Û¦X¥H­°¥ÌÅS¥Á²ö[m
[1;30m¤§¥O¦Ó¦Û§¡©l¨î¦³¦W¦W¥ç¬J¦³¤Ò¥ç±Nª¾¤îª¾¤î[37m61-231-195-189.dynamic.hinet.net[30m®ü[m
