µo«H¤H: qazq.bbs@bbs.cs.nchu.edu.tw (¡¯§Ú­n¬õ³z¦Û¤v©Ð¶¡¡¯) ¬ÝªO: plan
¼Ð  ÃD: [¥\¯à] ¶Ã¼Æ²£¥Í¼Æ¦r¡A¥H ASCII ¹Ï§ÎÅã¥Ü¡C
µo«H¯¸: ¤¤¿³¸ê¬ì ¢í¸ê¿W¨q (2005/07/19 Tue 11:18:40)       Updated: 2005/09/15

¡° ¤Þ­z¡mJayWilliam.bbs.NOSPAM@bbs.shu.edu.tw.SHU (#Åwªï¥úÁ{»A¨¦­·±¡#)¡n¤§»Ê¨¥
> ¯¸¤WºÃ¦ü¦³¼s§i°Ó¨Ï¥Î¦Û°Êµ{¦¡³sÄòµù¥U¡A
> ·Q½Ð°Ý¦³¨S¦³¿ìªk¦bµù¥U®É°µ¤@ÂI§ó°Ê¡A
> µù¥U«e¥ý­n¨D¿é¤JÀH¾÷²£¥Íªº¥|¦ì¼Æ¡A
> ¦pªG¿é¤J¥¿½T¤~¯à¶i¤U¤@¨B¶ñ¸ê®Æ¡H

: src/maple/bbsd.c:ascii_rand_num()  ¼W¥[¤U­±¾ã­Ó¨ç¦¡©ó acct_apply() «e­±

/* qazq.050719: ¶Ã¼Æ²£¥Í ascii ¼Æ¦r¹Ï§Î        */
/* ¶Ç¤J­È:                                     */
/*   x: ¹Ï§Î­n¶}©lÅã¥Üªº x ®y¼Ð                */
/*   y: ¹Ï§Î­n¶}©lÅã¥Üªº y ®y¼Ð                */
/*   max_bit: ­n¶Ã¼Æ²£¥Íªº³Ì¤j¦ì¼Æ             */
/*     (¶Ç¤J 4 ªº¸Ü´N¬O²£¥Í 0 ~ 9999)          */
/*   pattern: ¹Ï§Î­n¥Î¤°»ò¼Ëªº¦r¤¸Åã¥Ü         */
/*     (¶Ç¤J -1 ¬°¶Ã¼ÆÅã¥Ü, ¶Ç '#' ´N¬O¥Î¥¦    */
/* ¦^¶Ç­È:                                     */
/*   ¶Ã¼Æ²£¥Íªº¾ã¼Æ                            */
/*                                             */
/* ª`·N¨Æ¶µ:                                   */
/*   1. ³Ì¤j¦ì¤£­n¶W¹L 5¡A¦]¬°¶Ã¼Æ³Ì¤j¨ì 32767 */
/*      ­nÂX¥Rªº¥i¥H¦Û¤v­×§ïµ{¦¡¡C             */
/*   2. ¨C¤@­Ó ascii ¼Æ¦r»Ý­n 5 * 5 ªºªÅ¶¡     */
/*   3. ¨C­Ó ascii ¼Æ¦r¤¤¶¡·|ªÅ¥Õ¤@¦æ          */

static int
ascii_rand_num(x, y, max_bit, pattern)
  int x;
  int y;
  int max_bit;
  char pattern;
{
  static char numList[10][5][5] =
  {
    {
      1,1,1,1,1,
      1,0,0,0,1,
      1,0,0,0,1,
      1,0,0,0,1,
      1,1,1,1,1
    },
    {
      0,0,0,1,0,
      0,0,0,1,0,
      0,0,0,1,0,
      0,0,0,1,0,
      0,0,0,1,0
    },
    {
      1,1,1,1,1,
      0,0,0,0,1,
      1,1,1,1,1,
      1,0,0,0,0,
      1,1,1,1,1
    },
    {
      1,1,1,1,1,
      0,0,0,0,1,
      1,1,1,1,1,
      0,0,0,0,1,
      1,1,1,1,1
    },
    {
      1,0,0,0,1,
      1,0,0,0,1,
      1,1,1,1,1,
      0,0,0,0,1,
      0,0,0,0,1
    },
    {
      1,1,1,1,1,
      1,0,0,0,0,
      1,1,1,1,1,
      0,0,0,0,1,
      1,1,1,1,1
    },
    {
      1,0,0,0,0,
      1,0,0,0,0,
      1,1,1,1,1,
      1,0,0,0,1,
      1,1,1,1,1
    },
    {
      1,1,1,1,1,
      0,0,0,0,1,
      0,0,0,0,1,
      0,0,0,0,1,
      0,0,0,0,1
    },
    {
      1,1,1,1,1,
      1,0,0,0,1,
      1,1,1,1,1,
      1,0,0,0,1,
      1,1,1,1,1
    },
    {
      1,1,1,1,1,
      1,0,0,0,1,
      1,1,1,1,1,
      0,0,0,0,1,
      0,0,0,0,1
    }
  };
  /* ¶Ã¼Æ pattern ¥Î */
  char pattern_list[5] = {'#','@','$','&','%'};
  int i, j, k;
  int rnd_num, numIndex;
  char buf[32];

  /* qazq: Linux ¤U­±¨S¦³ pow() ¥u¦n¦Û¤v¼g¤@­Ó....^^a */
  //rnd = rand() % (int)(pow(10, max_bit));
  for (rnd_num = i = 1; i <= max_bit; i++)
    rnd_num *= 10;
  rnd_num = rand() % rnd_num;
  sprintf(buf, "%0*d", max_bit, rnd_num);

  for (i = 0; i <= 4; i++)  /* °ª«× 5¡A¤@¦¸Åã¥Ü¤@¦C */
  {
    move(x + i, y);
    for (j = 0; j <= max_bit - 1; j++) /* ¦³ max_bit ­Ó¼Æ¦r­nÅã¥Ü */
    {
      numIndex = buf[j] - '0';
      for (k = 0; k <= 4; k++)  /* ¨C­Ó¼Æ¦r¼e«× 5¡A¤@¦¸Åã¥Ü¤@­Ó¦r¤¸ */
      {
        prints("%c", numList[numIndex][i][k] == 1 ?
          (pattern == -1 ? pattern_list[rand()%5] : pattern) : ' ');
      }

      outs(" ");  /* ¨C­Ó ascii ¼Æ¦r¶¡®æ¤@­ÓªÅ¥Õ */
    }
  }

  return rnd_num;
}

: src/maple/bbsd.c:acct_apply()

  film_out(FILM_APPLY, 0);

+ vmsg(NULL);
+ try = ascii_rand_num(0, 0, 4, -1);
  [1;44m// move(11, 0) ¶}©lÅã¥Ü¥|¦ì¼Æ¦rªº ASCII ¹Ï§Î¡A¹Ï§Îªº¦r¤¸¥Î¶Ã¼Æ²£¥Í¡C[m

+ vget(17, 0, "½Ð¿é¤J¤W¤è©ÒÅã¥Üªº¥|¦ì¼Æ¦r", buf, 5, DOECHO);
+ if (atoi(buf) != try)
+   login_abort("\n¦A¨£ ...");

: src/maple/bbsd.c:tn_login()

  sprintf(buf, "%s ip:%08x (%d)", fromhost, tn_addr, currpid);

+ srand(ap_start * tn_addr * currpid);

  multi = login_user(buf);

  ...
  ...

- srand(ap_start * cuser.userno * currpid);
}

==============================================================================

    ¶K¤@¨Çµ²ªG...

          @     &&%$@ %   & $@#%#
          #     @     #   @     $
          #%$#$ &#%@$ &@&## @%%##
¡@        %   %     @     @     #
          &@$## @&%&&     @ &&&%&


          ##### ##### ##### ##### #####
          #   #     # #   #     # #
          #   # ##### ##### ##### #####
          #   # #         #     #     #
          ##### #####     # ##### #####


          QQQQQ QQQQQ QQQQQ
              Q     Q Q   Q
              Q QQQQQ QQQQQ
              Q     Q     Q
              Q QQQQQ     Q


    ¤j·§´N¬O³o¼Ë¡I^^

    µ{¦¡¦³¼g¤£¦nªº¦a¤è¡A§Æ±æ¤j®a¥i¥HÀ°¦£­×¥¿¡I^^


[m--
[32mùÝ¢¡[46m      [34m¢f¢h¢g¢h¢i¢g¢f¢h¢f¢e¢h¢g¢f¢g¢e[1;33m ¡³[37m ¡E . [;46m¡C [1;37m£j [;34;46m£» ¡O[37m¡D£j[1;33;40;m . [;33m£»[1m¡O  [37m¡³[36m£][m
[32m¢¢ùå¢~ùß[30;44m¢o[37m  ¤ÑªÅ¤§«° (qazq.twbbs.org) [34;40m¢o[33m£j [36m¡C  [1;30m£i´Á«Ý[m¦bªÅ¤¤[1m»P§A¬Û·| [33m¡C   [36m£_[0;37m¡¿[m
[32m    ùã¢£ [30;44m¢e¢d¢e¢f[37m¢e¢c¢f¢g¢e¢c¢g¢e¢c¢f¢g[;31;47m    218-163-163-60.dynamic.hinet.net[m [1;35m¡©[m
