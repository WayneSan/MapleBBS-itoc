§@ªÌ: itoc (¤£¤Óµo®i¹êÅç«Ç) ¬ÝªO: plan
¼ÐÃD: [¥\¯à] µL²áªº NPC
®É¶¡: Tue Sep  3 11:54:28 2002                          Updated: 2003/08/17

  ¥á¤ô²yµ¹ userlevel=0 (¤]´N¬O guest) ªº NPC (non-player-char.)
  NPC ·|¦^¤ô²yµ¹§A

  ¦pªG¥á guest ¤ô²y
  °Ý "½Ð°Ý¦p¦ó¶}ªO"  NPC ·|µª "¶}ªO½Ð¦Ü [newboard] ªO post"
  °Ý "½Ð°Ý¯¸ªø¬O½Ö"  NPC ·|µª "¥»¯¸ªº¯¸ªø¬O sysop"
  ¦pªG¸ò guest ÀH«K¥á¤ô²y¡Aguest ¤]·|¦^§A¸Ü

  ¦pªG·Q§â NPC §ï¬°§Oªº id
  ´N§â¨º­Ó id ªº©Ò¦³Åv­­³£®³±¼§Y¥i

: ufo.h

#define UFO_DEFAULT_GUEST       (UFO_COLOR | UFO_BRDNOTE | ...)

              ®³±¼ UFO_PAGER¡AÅý¨Ï¥ÎªÌ¥i¥H¥á guest ¤ô²y

: bmw.c:bmw_edit()

    if (up)     /* ¤£¬O¼s¼½ */
    {
+     if (!(up->userlevel))     /* guest ¬O NPC */
+     {
+       bmw->sender = 0;        /* ¤£¥i¦^ÂÐ */
+       bmw->recver = cuser.userno;
+       strcpy(bmw->userid, "§Ú¬O NPC");
+       bmw_npcAI(bmw->msg);
+       bmw_send(cutmp, bmw);
+       return;
+     }
+     else
+     {
        /* °e¥X¤ô²y */
        bmw->recver = recver;
        strcpy(bmw->userid, userid);
        if (bmw_send(up, bmw))
          vmsg(MSG_USR_LEFT);

        /* lkchu.990103: ­Y¬O¦Û¤v°e¥Xªº¤ô²y¡A¦s¹ï¤èªº userid */
        strcpy(bmw->userid, up->userid);
+     }
    }

: bmw.c:bmw_npcAI() ·s¼W©ó bmw_edit() «e­±

static void
bmw_npcAI(msg)      /* Non-Player-Char ªº¤H¤u´¼¼z */
  char *msg;        /* bmw.msg ªø«×¬O 69 */
{
  /* input msg ¬O¨Ï¥ÎªÌ©Ò¿é¤J­nµ¹ guest ªº¤ô²y */
  /* output ¤]¥Î msg¡A¬O NPC ¦^µ¹ cuser.userid ªº¤ô²y */

  int find;
  FILE *fp;
  char rule[80], ans[80], *str;

  find = 0;
  if (fp = fopen("etc/npc", "r"))
  {
    while (fgets(rule, 80, fp))
    {
      if (!fgets(ans, 80, fp))
        break;

      if (str = strchr(rule, '\n'))
        *str = '\0';
      if (strstr(msg, rule))
      {
        if (str = strchr(ans, '\n'))
          *str = '\0';
        str_ncpy(msg, ans, 60);
        find = 1;
        break;
      }
    }

    fclose(fp);
  }

  if (!find)        /* ¦pªG rule ¸Ì­±¨S¦³¡A´NÀH«K¦^µª */
    strcpy(msg, "Á¿¤Ó¤pÁn¤F¡A§ÚÅ¥¤£¨ì");
}

: etc/npc ·s¼W³o­ÓÀÉ®×¡G©_¼Æ¦æ¬O³W«h¡A°¸¼Æ¦æ¬O­n¦^µªªº¸Ü¡A½d¨Ò¦p¤U¡G
: ¦pªG­n§ï NPC ªº AI¡A´N§ï etc/npc §Y¥i

> ---------- ½d¨Ò±q¤U¤@¦æ¶}©l¡A¤£¥]¬A¥»¦æ ---------- <
¦­¦w
¤£¦­¤F°Ú¡A§Ú¨C¤Ñ³£ºÎ¨ì¤¤¤Èªº»¡
¤Ñ®ð
¤µ¤Ñ¤Ñ®ð¥i¦nªº«Ü©O¡ã
¬°¤°»ò
§A³o»òÁo©ú³£¤£ª¾¹D¤F¡A§Ú«ç»ò¥i¯à·|ª¾¹D
¶}ªO
¶}ªO½Ð¦Ü [newboard] ªO post
¯¸ªø
¥»¯¸ªº¯¸ªø¬O sysop
> ---------- ½d¨Ò¨ì¤W¤@¦æµ²§ô¡A¤£¥]¬A¥»¦æ ---------- <

--
[1;37m¡¼ ¥»¤å³¹¥Ñ [33mitoc[37m ±q [32mpc512-5.EE.NCTU.edu.tw[37m µoªí[m
